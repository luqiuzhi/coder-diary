# SQL中索引失效的场景

1. 模糊查询左匹配，如‘%xx’
2. where条件中使用子查询
3. 使用数据库函数处理字段，如：date_format(date, '%\Y-%m-%d')
4. 联合索引不满足最左匹配原则
5. 索引列经过了计算，与函数类同
6. 字段类型转换，显式和隐式
7. 查询条件使用or，例如`WHERE ID=1 OR NAME='张三'`，如果`NAME`本身没有索引，也会导致`ID`的索引失效
8. 查询时使用 `!=` 或者 `<>`，可能使索引失效，因为不等于某个值本身就代表这是一个较大的范围，优化器一般会认为全表扫描效率更高
9. 数据分布

## SQL和大表优化

1. join优化，小表驱动大表（left join），如果join时可以过滤，尽量把条件写在on子句上。
2. where 优化，主要是看看是否被索引覆盖。
3. select * 优化，减少大字段的查询，尽量往覆盖索引上靠。
4. 数据操作SQL，尽量使用批量操作
5. 索引优化，数据的区分度，索引字段的大小尽量小