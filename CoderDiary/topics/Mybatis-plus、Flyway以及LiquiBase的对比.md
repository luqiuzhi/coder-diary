# Mybatis-plus、Flyway以及Liquibase的对比（AutoDDL）

## MyBatis-Plus自动维护DDL与Flyway、Liquibase对比分析

### 一、核心定位差异

1. **MyBatis-Plus DDL自动维护**
    - **定位**：作为ORM框架的扩展功能，**内嵌于Java应用**，通过代码驱动SQL脚本执行，实现表结构动态维护（如创建表、存储过程等）。
    - **特点**：
        - 支持分库分表场景下的动态数据源切换。
        - 自动记录执行历史到`ddl_history`表，但缺乏版本回滚能力。
        - 适合需要**与业务代码深度结合**的简单DDL管理场景（如开发环境快速迭代）。

2. **Flyway/Liquibase**
    - **定位**：**独立数据库迁移工具**，专注于全生命周期的数据库版本管理（创建、升级、回滚），与语言/框架解耦。
    - **特点**：
        - Flyway以纯SQL脚本为核心，Liquibase支持SQL/XML/YAML/JSON多格式，适配跨数据库兼容需求。
        - 提供版本历史追踪、校验、回滚等企业级功能，适合生产环境严格变更管理。

---

### 二、功能特性对比

| **维度**     | **MyBatis-Plus DDL** | **Flyway**                    | **Liquibase**          |
|------------|----------------------|-------------------------------|------------------------|
| **脚本管理**   | SQL文件（支持存储过程）        | SQL文件（强制版本命名，如`V1__init.sql`） | XML/YAML/JSON（声明式变更描述） |
| **版本控制**   | 仅记录执行历史，无版本顺序控制      | 严格版本顺序，支持基线（Baseline）         | 变更集（ChangeSet）顺序管理     |
| **回滚支持**   | 无                    | 商业版支持回滚                       | 开源版支持回滚                |
| **多数据源支持** | 动态切换数据源执行脚本          | 需独立配置多数据源                     | 支持多数据源，需复杂配置           |
| **执行时机**   | 应用启动时自动执行            | 应用启动前独立执行                     | 独立执行或集成到应用启动流程         |

---

### 三、适用场景分析

1. **MyBatis-Plus DDL适用场景**
    - **快速原型开发**：无需独立部署工具，SQL脚本与代码仓库同步维护。
    - **分库分表动态扩展**：结合ShardingKey实现分库脚本执行。
    - **轻量级维护需求**：如初始化测试数据、临时表创建。

2. **Flyway/Liquibase适用场景**
    - **企业级数据库治理**：需严格版本控制、审计、多环境一致性（如生产环境表结构升级）。
    - **跨团队协作**：通过标准化的迁移脚本和变更日志实现协作。
    - **复杂回滚需求**：如线上故障时快速回退到历史版本。

---

### 四、技术选型建议

1. **选择MyBatis-Plus DDL的条件**
    - 项目已深度依赖MyBatis-Plus，且无复杂版本管理需求。
    - 开发环境需快速验证表结构变更，避免独立工具的学习成本。

2. **选择Flyway的条件**
    - 团队偏好纯SQL脚本管理，且需要开源免费的基础功能。
    - 生产环境需自动化执行脚本并记录详细变更历史。

3. **选择Liquibase的条件**
    - 需支持多种数据库（如同时管理MySQL和Oracle）。
    - 需声明式变更描述（如通过YAML定义表结构）。

---

### 五、局限性总结

| **工具**           | **主要局限性**                 |
|------------------|---------------------------|
| MyBatis-Plus DDL | 无回滚功能、版本管理薄弱，不适合生产环境关键变更  |
| Flyway           | 开源版缺乏回滚，复杂分库场景需手动处理脚本     |
| Liquibase        | XML/YAML配置复杂度高，性能低于纯SQL方案 |

**结论**：若项目需要**简单、轻量级**的DDL维护，MyBatis-Plus DDL是高效选择；若需**企业级数据库版本控制**
，Flyway或Liquibase更为合适，尤其推荐Liquibase应对多数据库兼容需求。